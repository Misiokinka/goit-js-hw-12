{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  const container = document.getElementById('container');\n  const containerLoader = document.getElementById('container-loader');\n  let galleryItem;\n\n  let totalHits;\n  let defaultImages = [];\n  let page = 1;\n  let searchResult;\n  removeLoader(containerLoader);\n\n  const formSearching = document.getElementById('formSearching');\n  const loadMoreBtn = document.createElement('button');\n  const inputSearch = document.getElementById('inputSearch');\n  const gallery = document.getElementById('gallery');\n\n  loadMoreBtn.textContent = 'Load more';\n  loadMoreBtn.classList.add('load-more-btn');\n  loadMoreBtn.id = 'load-more';\n\n  const apiKey = '42167626-5dd4d1124df4d491f669cdb42';\n\n  formSearching.addEventListener('submit', function (e) {\n    e.preventDefault();\n    defaultImages = [];\n\n    addLoader(containerLoader);\n    if (defaultImages.length) {\n      removeLoadBtn();\n    }\n\n    searchResult = inputSearch.value.trim();\n    if (!searchResult) {\n      iziToast.error({\n        title: 'Error',\n        message: 'The field is not allowed to be empty ',\n        position: 'topRight',\n      });\n      removeLoader(containerLoader);\n      return;\n    }\n    page = 1;\n    getGallery();\n  });\n\n  loadMoreBtn.addEventListener('click', async () => {\n    page++;\n    await getGallery();\n\n    const galleryItems = document.querySelectorAll('.gallery-item');\n    const lastGalleryItem = galleryItems[galleryItems.length - 1];\n    const height = lastGalleryItem.getBoundingClientRect().height * 2;\n\n    window.scrollBy({\n      top: height,\n      behavior: 'smooth',\n    });\n  });\n\n  async function getGallery() {\n    const apiUrl = 'https://pixabay.com/api/';\n    const requestData = {\n      key: apiKey,\n      q: searchResult,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page,\n    };\n    galleryItem = document.getElementById('gallery-item');\n    try {\n      const response = await axios.get(\n        `${apiUrl}?${new URLSearchParams(requestData)}`\n      );\n      if (response.data.hits.length === 0) {\n        iziToast.error({\n          title: 'Error',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n        });\n\n        if (!defaultImages.length) {\n          gallery.innerHTML = '';\n          return;\n        }\n        removeLoadBtn();\n        return;\n      }\n      totalHits = response.data.totalHits;\n      renderImages(response.data.hits);\n    } catch (error) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Something went wrong. Please try again later.',\n        position: 'topRight',\n      });\n      removeLoadBtn();\n    } finally {\n      removeLoader(containerLoader);\n    }\n  }\n\n  function removeLoadBtn() {\n    container.removeChild(loadMoreBtn);\n  }\n\n  function addLoadBtn() {\n    containerLoader.before(loadMoreBtn);\n  }\n\n  function removeLoader(containerLoader) {\n    if (containerLoader) {\n      containerLoader.style.display = 'none';\n    }\n  }\n\n  function addLoader(containerLoader) {\n    if (containerLoader) {\n      containerLoader.style.display = 'block';\n    }\n  }\n  function renderImages(images) {\n    const newArray = defaultImages.concat(images);\n    const newListImage = newArray.map(\n      image =>\n        `\n        <div class=\"gallery-item\" id=\"gallery-item\">\n      <a href=\"${image.largeImageURL}\" data-lightbox=\"gallery\" data-title=\"Likes: ${image.likes}, Views: ${image.views}, Comments: ${image.comments}, Downloads: ${image.downloads}\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" data-src=\"${image.largeImageURL}\" data-caption=\"Likes: ${image.likes}, Views: ${image.views}, Comments: ${image.comments}, Downloads: ${image.downloads}\">\n        </a>\n        <div class=\"image-block\">\n      <div class=\"block-item\">\n        <p class=\"block-label\">Likes:</p>\n        <p class=\"block-value\">${image.likes}</p>\n      </div>\n      <div class=\"block-item\">\n        <p class=\"block-label\">Views:</p>\n        <p class=\"block-value\">${image.views}</p>\n      </div>\n      <div class=\"block-item\">\n        <p class=\"block-label\">Comments:</p>\n        <p class=\"block-value\">${image.comments}</p>\n      </div>\n      <div class=\"block-item\">\n        <p class=\"block-label\">Downloads:</p>\n        <p class=\"block-value\">${image.downloads}</p>\n      </div>\n    </div>\n    </div>\n      `\n    );\n\n    gallery.innerHTML = newListImage.join('');\n    defaultImages = newArray;\n\n    if (newArray.length === totalHits) {\n      if (document.getElementById('load-more')) {\n        removeLoadBtn();\n      }\n      iziToast.error({\n        title: 'Error',\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n      });\n    } else {\n      addLoadBtn();\n    }\n\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n  }\n});\n"],"names":["container","containerLoader","totalHits","defaultImages","page","searchResult","removeLoader","formSearching","loadMoreBtn","inputSearch","gallery","apiKey","e","addLoader","removeLoadBtn","iziToast","getGallery","galleryItems","height","apiUrl","requestData","response","axios","renderImages","addLoadBtn","images","newArray","newListImage","image","SimpleLightbox"],"mappings":"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"}